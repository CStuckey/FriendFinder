<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Survey Page</title>

	<!-- Latest compiled and minified CSS & JS -->
  	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
  	<script src="https://code.jquery.com/jquery.js"></script>
  	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</head>
<body>
	<div class="container">
		
		<div class="text-left">
			<h1>Survey Questions</h1>
		</div>
		
		<hr>
		
		<h2 class="text-left">About You</h2>
		<form>
		  <div class="form-group">
		    <label for="input-name">Name (Required)</label>
		    <input type="text" class="form-control" id="input-name" placeholder="Amanda Awesome">
		  </div>
		  <div class="form-group">
		    <label for="input-photo">Link to Photo Image (Required)</label>
		    <input type="url" class="form-control" id="input-photo" placeholder="https://www.inputimagelinkhere.com">
		  </div>
  		</form>

		<hr>

	<div class="questions">	

		<h3><strong>Question 1</strong></h3>
		<h4>What is your first question?</h4>
		<select class="selectpicker" id="q1" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

		<h3><strong>Question 2</strong></h3>
		<h4>What is your second question?</h4>
		<select class="selectpicker" id="q2" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

		<h3><strong>Question 3</strong></h3>
		<h4>What is your third question?</h4>
		<select class="selectpicker" id="q3" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

		<h3><strong>Question 4</strong></h3>
		<h4>What is your fourth question?</h4>
		<select class="selectpicker" id="q4" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

		<h3><strong>Question 5</strong></h3>
		<h4>What is your fifth question?</h4>
		<select class="selectpicker" id="q5" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

		<h3><strong>Question 6</strong></h3>
		<h4>What is your sixth question?</h4>
		<select class="selectpicker" id="q6" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

		<h3><strong>Question 7</strong></h3>
		<h4>What is your seventh question?</h4>
		<select class="selectpicker" id="q7" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

		<h3><strong>Question 8</strong></h3>
		<h4>What is your eighth question?</h4>
		<select class="selectpicker" id="q8" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

		<h3><strong>Question 9</strong></h3>
		<h4>What is your ninth question?</h4>
		<select class="selectpicker" id="q9" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

		<h3><strong>Question 10</strong></h3>
		<h4>What is your tenth question?</h4>
		<select class="selectpicker" id="q10" data-live-search="true">
		  <option value=""></option>
		  <option value="1">1 (Strongly Disagree)</option>
		  <option value="2">2</option>
		  <option value="3">3</option>
		  <option value="4">4</option>
		  <option value="5">5 (Strongly Agree)</option>
		</select>

	</div>

	<br>	

	<!-- Submit Button for Survey -->
	<div class="text-left">
		<a href="/survey"><button type="button" class="btn btn-block btn-lg btn-primary" id="submit-btn" data-toggle="modal" data-target="#fuckModal"><span class="glyphicon glyphicon glyphicon-check"></span> Submit</button></a>
	</div>

	<hr>

	<!-- Modal -->
	<div class="modal fade" id="fuckModal" role="dialog">
		<div class="modal-dialog">
		  	<div class="modal-content">
		  		<div class="modal-header">
			        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
			        <h4 class="modal-title">Best Match</h4>
		      	</div>

		      	<div class="modal-body">
		      		<h5 class="modal-title" id="matchName"></h5>
		        	<img id="matchImage" src="" alt="">
		      	</div> <!-- modal-body -->

		      	<div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
		      	</div>

		  	</div> <!-- modal-content -->
	  	</div>
	</div>  <!-- modal-dialog -->

	<!-- Footer -->
	<footer class="footer">
		<div class="container">
			<p><a href="/api/friends">API Friends List</a> | <a href="https://github.com/CStuckey/FriendFinder">Github Repo</a></p>
		</div>
	</footer>
	
	<br>	

	</div> <!-- close container div -->

</body>
</html>

<!-- Below is critical to how form data will be sent to server -->
<script type="text/javascript">

	$("#submit-btn").on("click", function() {
		
		// Validate the survey inputs
		function validateForm() {
			var isValid = true;
			$(".form-control").each(function() {
				if($(this).val() === '' )
					isValid = false;
			});

			$(".selectpicker").each(function() {
				if( $(this).val() === "")
					isValid = false;
			})
			return isValid;
		}

		// when all fields and survey responses are valid
		if (validateForm() === true) {
			// grab the survey elements
			var newFriend = {
				name: $("#input-name").val().trim(),
				photo: $("#input-photo").val().trim(),
				scores: [$("#q1").val().trim(), $("#q2").val().trim(), $("#q3").val().trim(), $("#q4").val().trim(), $("#q5").val().trim(), $("#q6").val().trim(), $("#q7").val().trim(), $("#q8").val().trim(), $("#q9").val().trim(), $("#q10").val().trim()]
			};

			// grab URL of website
			// var currentURL = window.location.origin;

			$.post("/api/friends", newFriend).done(function(data) {
				//if(data) {
					console.log(data);
					// Grab the result from AJAX post to match the best match name and photo for display
					$("#matchName").text(data.name);
					$("#matchImage").attr("src", data.photo)

					// Show the modal with the best match
					$("#fuckModal").modal('show');
				//}

				$("#input-name").val("");
				$("#input-photo").val("");
				$("#q1").val("");
				$("#q2").val("");
				$("#q3").val("");
				$("#q4").val("");
				$("#q5").val("");
				$("#q6").val("");
				$("#q7").val("");
				$("#q8").val("");
				$("#q9").val("");
				$("#q10").val("");

			});
		}
		else {
			alert("Please fill your shit out in da fields before submitting!");
		}

		return false;

	}); // closing click function
	
</script>